<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: dns_message_structure Pages: 1 -->
<svg width="826pt" height="654pt"
 viewBox="0.00 0.00 826.00 654.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 650)">
<title>dns_message_structure</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-650 822,-650 822,4 -4,4"/>
<text text-anchor="middle" x="409" y="-627.6" font-family="Helvetica,sans-Serif" font-size="18.00">DNS Full Message Structure: Header, Question &amp; Answer</text>
<!-- message_structure -->
<g id="node1" class="node">
<title>message_structure</title>
<polygon fill="#d3d3d3" stroke="transparent" points="8,-587 8,-614 810,-614 810,-587 8,-587"/>
<polygon fill="none" stroke="black" points="8,-587 8,-614 810,-614 810,-587 8,-587"/>
<text text-anchor="start" x="334" y="-597.8" font-family="Times,serif" font-weight="bold" font-size="14.00">Header Section (12 bytes)</text>
<polygon fill="whitesmoke" stroke="transparent" points="8,-560 8,-587 268,-587 268,-560 8,-560"/>
<polygon fill="none" stroke="black" points="8,-560 8,-587 268,-587 268,-560 8,-560"/>
<text text-anchor="start" x="88" y="-570.8" font-family="Times,serif" font-weight="bold" font-size="14.00">Field Description</text>
<polygon fill="whitesmoke" stroke="transparent" points="268,-560 268,-587 410,-587 410,-560 268,-560"/>
<polygon fill="none" stroke="black" points="268,-560 268,-587 410,-587 410,-560 268,-560"/>
<text text-anchor="start" x="310" y="-570.8" font-family="Times,serif" font-weight="bold" font-size="14.00">Size (bits)</text>
<polygon fill="lightblue" stroke="transparent" points="410,-560 410,-587 610,-587 610,-560 410,-560"/>
<polygon fill="none" stroke="black" points="410,-560 410,-587 610,-587 610,-560 410,-560"/>
<text text-anchor="start" x="445" y="-570.8" font-family="Times,serif" font-weight="bold" font-size="14.00">Example Query Value</text>
<polygon fill="lightgreen" stroke="transparent" points="610,-560 610,-587 810,-587 810,-560 610,-560"/>
<polygon fill="none" stroke="black" points="610,-560 610,-587 810,-587 810,-560 610,-560"/>
<text text-anchor="start" x="637" y="-570.8" font-family="Times,serif" font-weight="bold" font-size="14.00">Example Response Value</text>
<polygon fill="none" stroke="black" points="8,-533 8,-560 268,-560 268,-533 8,-533"/>
<text text-anchor="start" x="14" y="-542.8" font-family="Times,serif" font-size="14.00">Packet Identifier (ID)</text>
<polygon fill="none" stroke="black" points="268,-533 268,-560 410,-560 410,-533 268,-533"/>
<text text-anchor="start" x="332" y="-542.8" font-family="Times,serif" font-size="14.00">16</text>
<polygon fill="none" stroke="black" points="410,-533 410,-560 610,-560 610,-533 410,-533"/>
<text text-anchor="start" x="482.5" y="-542.8" font-family="Times,serif" font-size="14.00">e.g., 1234</text>
<polygon fill="none" stroke="black" points="610,-533 610,-560 810,-560 810,-533 610,-533"/>
<text text-anchor="start" x="640.5" y="-542.8" font-family="Times,serif" font-size="14.00">1234 (must match query)</text>
<polygon fill="#ffffe0" stroke="transparent" points="8,-506 8,-533 268,-533 268,-506 8,-506"/>
<polygon fill="none" stroke="black" points="8,-506 8,-533 268,-533 268,-506 8,-506"/>
<text text-anchor="start" x="14" y="-516.8" font-family="Times,serif" font-weight="bold" font-size="14.00">Flags</text>
<polygon fill="#ffffe0" stroke="transparent" points="268,-506 268,-533 410,-533 410,-506 268,-506"/>
<polygon fill="none" stroke="black" points="268,-506 268,-533 410,-533 410,-506 268,-506"/>
<text text-anchor="start" x="332" y="-516.8" font-family="Times,serif" font-weight="bold" font-size="14.00">16</text>
<polygon fill="#ffffe0" stroke="transparent" points="410,-506 410,-533 610,-533 610,-506 410,-506"/>
<polygon fill="none" stroke="black" points="410,-506 410,-533 610,-533 610,-506 410,-506"/>
<text text-anchor="start" x="439.5" y="-515.8" font-family="Times,serif" font-size="14.00">e.g., 0x0100 (Query, RD)</text>
<polygon fill="#ffffe0" stroke="transparent" points="610,-506 610,-533 810,-533 810,-506 610,-506"/>
<polygon fill="none" stroke="black" points="610,-506 610,-533 810,-533 810,-506 610,-506"/>
<text text-anchor="start" x="630" y="-515.8" font-family="Times,serif" font-size="14.00">e.g., 0x8180 (Response, RA)</text>
<polygon fill="none" stroke="black" points="8,-479 8,-506 268,-506 268,-479 8,-479"/>
<text text-anchor="start" x="14" y="-488.8" font-family="Times,serif" font-size="14.00">Question Count (QDCOUNT)</text>
<polygon fill="none" stroke="black" points="268,-479 268,-506 410,-506 410,-479 268,-479"/>
<text text-anchor="start" x="332" y="-488.8" font-family="Times,serif" font-size="14.00">16</text>
<polygon fill="none" stroke="black" points="410,-479 410,-506 610,-506 610,-479 410,-479"/>
<text text-anchor="start" x="506.5" y="-488.8" font-family="Times,serif" font-size="14.00">1</text>
<polygon fill="none" stroke="black" points="610,-479 610,-506 810,-506 810,-479 610,-479"/>
<text text-anchor="start" x="706.5" y="-488.8" font-family="Times,serif" font-size="14.00">1</text>
<polygon fill="none" stroke="black" points="8,-452 8,-479 268,-479 268,-452 8,-452"/>
<text text-anchor="start" x="14" y="-461.8" font-family="Times,serif" font-size="14.00">Answer Record Count (ANCOUNT)</text>
<polygon fill="none" stroke="black" points="268,-452 268,-479 410,-479 410,-452 268,-452"/>
<text text-anchor="start" x="332" y="-461.8" font-family="Times,serif" font-size="14.00">16</text>
<polygon fill="none" stroke="black" points="410,-452 410,-479 610,-479 610,-452 410,-452"/>
<text text-anchor="start" x="506.5" y="-461.8" font-family="Times,serif" font-size="14.00">0</text>
<polygon fill="none" stroke="black" points="610,-452 610,-479 810,-479 810,-452 610,-452"/>
<text text-anchor="start" x="676.5" y="-462.8" font-family="Times,serif" font-weight="bold" font-size="14.00">1 (or more)</text>
<polygon fill="none" stroke="black" points="8,-425 8,-452 268,-452 268,-425 8,-425"/>
<text text-anchor="start" x="14" y="-434.8" font-family="Times,serif" font-size="14.00">Authority Record Count (NSCOUNT)</text>
<polygon fill="none" stroke="black" points="268,-425 268,-452 410,-452 410,-425 268,-425"/>
<text text-anchor="start" x="332" y="-434.8" font-family="Times,serif" font-size="14.00">16</text>
<polygon fill="none" stroke="black" points="410,-425 410,-452 610,-452 610,-425 410,-425"/>
<text text-anchor="start" x="506.5" y="-434.8" font-family="Times,serif" font-size="14.00">0</text>
<polygon fill="none" stroke="black" points="610,-425 610,-452 810,-452 810,-425 610,-425"/>
<text text-anchor="start" x="706.5" y="-434.8" font-family="Times,serif" font-size="14.00">0</text>
<polygon fill="none" stroke="black" points="8,-398 8,-425 268,-425 268,-398 8,-398"/>
<text text-anchor="start" x="14" y="-407.8" font-family="Times,serif" font-size="14.00">Additional Record Count (ARCOUNT)</text>
<polygon fill="none" stroke="black" points="268,-398 268,-425 410,-425 410,-398 268,-398"/>
<text text-anchor="start" x="332" y="-407.8" font-family="Times,serif" font-size="14.00">16</text>
<polygon fill="none" stroke="black" points="410,-398 410,-425 610,-425 610,-398 410,-398"/>
<text text-anchor="start" x="506.5" y="-407.8" font-family="Times,serif" font-size="14.00">0</text>
<polygon fill="none" stroke="black" points="610,-398 610,-425 810,-425 810,-398 610,-398"/>
<text text-anchor="start" x="706.5" y="-407.8" font-family="Times,serif" font-size="14.00">0</text>
<polygon fill="#d3d3d3" stroke="transparent" points="8,-371 8,-398 810,-398 810,-371 8,-371"/>
<polygon fill="none" stroke="black" points="8,-371 8,-398 810,-398 810,-371 8,-371"/>
<text text-anchor="start" x="309.5" y="-381.8" font-family="Times,serif" font-weight="bold" font-size="14.00">Question Section (variable length)</text>
<polygon fill="whitesmoke" stroke="transparent" points="8,-344 8,-371 268,-371 268,-344 8,-344"/>
<polygon fill="none" stroke="black" points="8,-344 8,-371 268,-371 268,-344 8,-344"/>
<text text-anchor="start" x="88" y="-354.8" font-family="Times,serif" font-weight="bold" font-size="14.00">Field Description</text>
<polygon fill="whitesmoke" stroke="transparent" points="268,-344 268,-371 410,-371 410,-344 268,-344"/>
<polygon fill="none" stroke="black" points="268,-344 268,-371 410,-371 410,-344 268,-344"/>
<text text-anchor="start" x="327" y="-354.8" font-family="Times,serif" font-weight="bold" font-size="14.00">Size</text>
<polygon fill="whitesmoke" stroke="transparent" points="410,-344 410,-371 810,-371 810,-344 410,-344"/>
<polygon fill="none" stroke="black" points="410,-344 410,-371 810,-371 810,-344 410,-344"/>
<text text-anchor="start" x="540.5" y="-354.8" font-family="Times,serif" font-weight="bold" font-size="14.00">Example &amp; Description</text>
<polygon fill="none" stroke="black" points="8,-304 8,-344 268,-344 268,-304 8,-304"/>
<text text-anchor="start" x="14" y="-320.3" font-family="Times,serif" font-size="14.00">Name (QNAME)</text>
<polygon fill="none" stroke="black" points="268,-304 268,-344 410,-344 410,-304 268,-304"/>
<text text-anchor="start" x="316" y="-320.3" font-family="Times,serif" font-size="14.00">Variable</text>
<polygon fill="none" stroke="black" points="410,-304 410,-344 810,-344 810,-304 410,-304"/>
<text text-anchor="start" x="439" y="-327.8" font-family="Times,serif" font-size="14.00">Domain name encoded as labels prefixed with length bytes.</text>
<text text-anchor="start" x="416" y="-313.8" font-family="Times,serif" font-size="14.00">e.g., `codecrafters.io` becomes `\x0c` </text>
<text text-anchor="start" x="625" y="-313.8" font-family="Times,serif" font-weight="bold" font-size="14.00">codecrafters</text>
<text text-anchor="start" x="697" y="-313.8" font-family="Times,serif" font-size="14.00"> `\x02` </text>
<text text-anchor="start" x="738" y="-313.8" font-family="Times,serif" font-weight="bold" font-size="14.00">io</text>
<text text-anchor="start" x="749" y="-313.8" font-family="Times,serif" font-size="14.00"> `\x00`.</text>
<polygon fill="none" stroke="black" points="8,-277 8,-304 268,-304 268,-277 8,-277"/>
<text text-anchor="start" x="14" y="-286.8" font-family="Times,serif" font-size="14.00">Type (QTYPE)</text>
<polygon fill="none" stroke="black" points="268,-277 268,-304 410,-304 410,-277 268,-277"/>
<text text-anchor="start" x="320.5" y="-286.8" font-family="Times,serif" font-size="14.00">16 bits</text>
<polygon fill="none" stroke="black" points="410,-277 410,-304 810,-304 810,-277 410,-277"/>
<text text-anchor="start" x="557.5" y="-286.8" font-family="Times,serif" font-size="14.00">1 (A record &#45; IPv4)</text>
<polygon fill="none" stroke="black" points="8,-250 8,-277 268,-277 268,-250 8,-250"/>
<text text-anchor="start" x="14" y="-259.8" font-family="Times,serif" font-size="14.00">Class (QCLASS)</text>
<polygon fill="none" stroke="black" points="268,-250 268,-277 410,-277 410,-250 268,-250"/>
<text text-anchor="start" x="320.5" y="-259.8" font-family="Times,serif" font-size="14.00">16 bits</text>
<polygon fill="none" stroke="black" points="410,-250 410,-277 810,-277 810,-250 410,-250"/>
<text text-anchor="start" x="566" y="-259.8" font-family="Times,serif" font-size="14.00">1 (IN &#45; Internet)</text>
<polygon fill="#d3d3d3" stroke="transparent" points="8,-223 8,-250 810,-250 810,-223 8,-223"/>
<polygon fill="none" stroke="black" points="8,-223 8,-250 810,-250 810,-223 8,-223"/>
<text text-anchor="start" x="242" y="-233.8" font-family="Times,serif" font-weight="bold" font-size="14.00">Answer Section (contains one or more Resource Records)</text>
<polygon fill="whitesmoke" stroke="transparent" points="8,-196 8,-223 268,-223 268,-196 8,-196"/>
<polygon fill="none" stroke="black" points="8,-196 8,-223 268,-223 268,-196 8,-196"/>
<text text-anchor="start" x="88" y="-206.8" font-family="Times,serif" font-weight="bold" font-size="14.00">Field Description</text>
<polygon fill="whitesmoke" stroke="transparent" points="268,-196 268,-223 410,-223 410,-196 268,-196"/>
<polygon fill="none" stroke="black" points="268,-196 268,-223 410,-223 410,-196 268,-196"/>
<text text-anchor="start" x="327" y="-206.8" font-family="Times,serif" font-weight="bold" font-size="14.00">Size</text>
<polygon fill="whitesmoke" stroke="transparent" points="410,-196 410,-223 810,-223 810,-196 410,-196"/>
<polygon fill="none" stroke="black" points="410,-196 410,-223 810,-223 810,-196 410,-196"/>
<text text-anchor="start" x="492.5" y="-206.8" font-family="Times,serif" font-weight="bold" font-size="14.00">Example &amp; Description for an A Record</text>
<polygon fill="none" stroke="black" points="8,-154 8,-196 268,-196 268,-154 8,-154"/>
<text text-anchor="start" x="14" y="-171.3" font-family="Times,serif" font-size="14.00">Name</text>
<polygon fill="none" stroke="black" points="268,-154 268,-196 410,-196 410,-154 268,-154"/>
<text text-anchor="start" x="316" y="-171.3" font-family="Times,serif" font-size="14.00">Variable</text>
<polygon fill="none" stroke="black" points="410,-154 410,-196 810,-196 810,-154 410,-154"/>
<text text-anchor="start" x="439.5" y="-178.8" font-family="Times,serif" font-size="14.00">The same domain name. Usually compressed to save space.</text>
<text text-anchor="start" x="416" y="-163.8" font-family="Times,serif" font-size="14.00">e.g., a 2&#45;byte pointer `\xc0\x0c` which means &quot;name is at offset 12&quot;.</text>
<polygon fill="none" stroke="black" points="8,-127 8,-154 268,-154 268,-127 8,-127"/>
<text text-anchor="start" x="14" y="-136.8" font-family="Times,serif" font-size="14.00">Type</text>
<polygon fill="none" stroke="black" points="268,-127 268,-154 410,-154 410,-127 268,-127"/>
<text text-anchor="start" x="320.5" y="-136.8" font-family="Times,serif" font-size="14.00">16 bits</text>
<polygon fill="none" stroke="black" points="410,-127 410,-154 810,-154 810,-127 410,-127"/>
<text text-anchor="start" x="576.5" y="-136.8" font-family="Times,serif" font-size="14.00">1 (A record)</text>
<polygon fill="none" stroke="black" points="8,-100 8,-127 268,-127 268,-100 8,-100"/>
<text text-anchor="start" x="14" y="-109.8" font-family="Times,serif" font-size="14.00">Class</text>
<polygon fill="none" stroke="black" points="268,-100 268,-127 410,-127 410,-100 268,-100"/>
<text text-anchor="start" x="320.5" y="-109.8" font-family="Times,serif" font-size="14.00">16 bits</text>
<polygon fill="none" stroke="black" points="410,-100 410,-127 810,-127 810,-100 410,-100"/>
<text text-anchor="start" x="566" y="-109.8" font-family="Times,serif" font-size="14.00">1 (IN &#45; Internet)</text>
<polygon fill="none" stroke="black" points="8,-73 8,-100 268,-100 268,-73 8,-73"/>
<text text-anchor="start" x="14" y="-82.8" font-family="Times,serif" font-size="14.00">TTL (Time&#45;To&#45;Live)</text>
<polygon fill="none" stroke="black" points="268,-73 268,-100 410,-100 410,-73 268,-73"/>
<text text-anchor="start" x="320.5" y="-82.8" font-family="Times,serif" font-size="14.00">32 bits</text>
<polygon fill="none" stroke="black" points="410,-73 410,-100 810,-100 810,-73 410,-73"/>
<text text-anchor="start" x="416" y="-82.8" font-family="Times,serif" font-size="14.00">Duration in seconds this record can be cached. e.g., 3600</text>
<polygon fill="none" stroke="black" points="8,-46 8,-73 268,-73 268,-46 8,-46"/>
<text text-anchor="start" x="14" y="-55.8" font-family="Times,serif" font-size="14.00">Length (RDLENGTH)</text>
<polygon fill="none" stroke="black" points="268,-46 268,-73 410,-73 410,-46 268,-46"/>
<text text-anchor="start" x="320.5" y="-55.8" font-family="Times,serif" font-size="14.00">16 bits</text>
<polygon fill="none" stroke="black" points="410,-46 410,-73 810,-73 810,-46 410,-46"/>
<text text-anchor="start" x="416" y="-56.8" font-family="Times,serif" font-size="14.00">Length of the Data field. For an A record, this is always </text>
<text text-anchor="start" x="726" y="-56.8" font-family="Times,serif" font-weight="bold" font-size="14.00">4</text>
<text text-anchor="start" x="733" y="-56.8" font-family="Times,serif" font-size="14.00">.</text>
<polygon fill="none" stroke="black" points="8,-4 8,-46 268,-46 268,-4 8,-4"/>
<text text-anchor="start" x="14" y="-21.3" font-family="Times,serif" font-size="14.00">Data (RDATA)</text>
<polygon fill="none" stroke="black" points="268,-4 268,-46 410,-46 410,-4 268,-4"/>
<text text-anchor="start" x="274" y="-21.3" font-family="Times,serif" font-size="14.00">Variable (4 bytes for A)</text>
<polygon fill="none" stroke="black" points="410,-4 410,-46 810,-46 810,-4 410,-4"/>
<text text-anchor="start" x="416" y="-28.8" font-family="Times,serif" font-size="14.00">The actual data. For an A record, this is the 4&#45;byte IPv4 address.</text>
<text text-anchor="start" x="534" y="-13.8" font-family="Times,serif" font-size="14.00">e.g., `93.184.216.34`</text>
</g>
</g>
</svg>
