<?xml version="1.0" encoding="UTF-8" standalone="no"?>
<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN"
 "http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">
<!-- Generated by graphviz version 2.43.0 (0)
 -->
<!-- Title: dns_forwarder_bit_flow Pages: 1 -->
<svg width="489pt" height="1719pt"
 viewBox="0.00 0.00 489.00 1719.00" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink">
<g id="graph0" class="graph" transform="scale(1 1) rotate(0) translate(4 1715)">
<title>dns_forwarder_bit_flow</title>
<polygon fill="white" stroke="transparent" points="-4,4 -4,-1715 485,-1715 485,4 -4,4"/>
<text text-anchor="middle" x="240.5" y="-1695.8" font-family="Times,serif" font-size="14.00">DNS Forwarder: Byte&#45;Level Data Manipulation Flow</text>
<!-- client_query -->
<g id="node1" class="node">
<title>client_query</title>
<path fill="beige" stroke="transparent" d="M351,-1688C351,-1688 130,-1688 130,-1688 124,-1688 118,-1682 118,-1676 118,-1676 118,-1499 118,-1499 118,-1493 124,-1487 130,-1487 130,-1487 351,-1487 351,-1487 357,-1487 363,-1493 363,-1499 363,-1499 363,-1676 363,-1676 363,-1682 357,-1688 351,-1688"/>
<polygon fill="lightblue" stroke="transparent" points="126.5,-1662.5 126.5,-1683.5 355.5,-1683.5 355.5,-1662.5 126.5,-1662.5"/>
<polygon fill="none" stroke="black" points="126.5,-1662.5 126.5,-1683.5 355.5,-1683.5 355.5,-1662.5 126.5,-1662.5"/>
<text text-anchor="start" x="131" y="-1670.3" font-family="Times,serif" font-weight="bold" font-size="14.00">1. Client Query (Received in `buffer`)</text>
<polygon fill="none" stroke="black" points="126.5,-1641.5 126.5,-1662.5 199.5,-1662.5 199.5,-1641.5 126.5,-1641.5"/>
<text text-anchor="start" x="136.5" y="-1648.3" font-family="Times,serif" font-size="14.00">Bytes 0&#45;1</text>
<polygon fill="none" stroke="black" points="199.5,-1641.5 199.5,-1662.5 355.5,-1662.5 355.5,-1641.5 199.5,-1641.5"/>
<text text-anchor="start" x="241" y="-1648.3" font-family="Times,serif" font-size="14.00" fill="blue">ID: 0xABCD</text>
<polygon fill="none" stroke="black" points="126.5,-1620.5 126.5,-1641.5 199.5,-1641.5 199.5,-1620.5 126.5,-1620.5"/>
<text text-anchor="start" x="136.5" y="-1627.3" font-family="Times,serif" font-size="14.00">Bytes 2&#45;3</text>
<polygon fill="none" stroke="black" points="199.5,-1620.5 199.5,-1641.5 355.5,-1641.5 355.5,-1620.5 199.5,-1620.5"/>
<text text-anchor="start" x="202.5" y="-1627.3" font-family="Times,serif" font-size="14.00" fill="blue">Flags: 0x0100 (Query, RD)</text>
<polygon fill="none" stroke="black" points="126.5,-1599.5 126.5,-1620.5 199.5,-1620.5 199.5,-1599.5 126.5,-1599.5"/>
<text text-anchor="start" x="136.5" y="-1606.3" font-family="Times,serif" font-size="14.00">Bytes 4&#45;5</text>
<polygon fill="none" stroke="black" points="199.5,-1599.5 199.5,-1620.5 355.5,-1620.5 355.5,-1599.5 199.5,-1599.5"/>
<text text-anchor="start" x="237.5" y="-1606.3" font-family="Times,serif" font-size="14.00" fill="blue">QDCOUNT: 1</text>
<polygon fill="none" stroke="black" points="126.5,-1578.5 126.5,-1599.5 199.5,-1599.5 199.5,-1578.5 126.5,-1578.5"/>
<text text-anchor="start" x="133" y="-1585.3" font-family="Times,serif" font-size="14.00">Bytes 6&#45;11</text>
<polygon fill="none" stroke="black" points="199.5,-1578.5 199.5,-1599.5 355.5,-1599.5 355.5,-1578.5 199.5,-1578.5"/>
<text text-anchor="start" x="215.5" y="-1585.3" font-family="Times,serif" font-size="14.00">AN/NS/ARCOUNT: 0</text>
<polygon fill="lightgrey" stroke="transparent" points="126.5,-1553.5 126.5,-1574.5 355.5,-1574.5 355.5,-1553.5 126.5,-1553.5"/>
<polygon fill="none" stroke="black" points="126.5,-1553.5 126.5,-1574.5 355.5,-1574.5 355.5,-1553.5 126.5,-1553.5"/>
<text text-anchor="start" x="194.5" y="-1561.3" font-family="Times,serif" font-style="italic" font-size="14.00">Question Section</text>
<polygon fill="none" stroke="black" points="126.5,-1532.5 126.5,-1553.5 199.5,-1553.5 199.5,-1532.5 126.5,-1532.5"/>
<text text-anchor="start" x="129.5" y="-1539.3" font-family="Times,serif" font-size="14.00">Bytes 12&#45;23</text>
<polygon fill="none" stroke="black" points="199.5,-1532.5 199.5,-1553.5 355.5,-1553.5 355.5,-1532.5 199.5,-1532.5"/>
<text text-anchor="start" x="203" y="-1539.3" font-family="Times,serif" font-size="14.00" fill="blue">QNAME: 7example3com0</text>
<polygon fill="none" stroke="black" points="126.5,-1511.5 126.5,-1532.5 199.5,-1532.5 199.5,-1511.5 126.5,-1511.5"/>
<text text-anchor="start" x="129.5" y="-1518.3" font-family="Times,serif" font-size="14.00">Bytes 24&#45;25</text>
<polygon fill="none" stroke="black" points="199.5,-1511.5 199.5,-1532.5 355.5,-1532.5 355.5,-1511.5 199.5,-1511.5"/>
<text text-anchor="start" x="216" y="-1518.3" font-family="Times,serif" font-size="14.00" fill="blue">QTYPE: 1 (A Record)</text>
<polygon fill="none" stroke="black" points="126.5,-1490.5 126.5,-1511.5 199.5,-1511.5 199.5,-1490.5 126.5,-1490.5"/>
<text text-anchor="start" x="129.5" y="-1497.3" font-family="Times,serif" font-size="14.00">Bytes 26&#45;27</text>
<polygon fill="none" stroke="black" points="199.5,-1490.5 199.5,-1511.5 355.5,-1511.5 355.5,-1490.5 199.5,-1490.5"/>
<text text-anchor="start" x="230.5" y="-1497.3" font-family="Times,serif" font-size="14.00" fill="blue">QCLASS: 1 (IN)</text>
</g>
<!-- action1 -->
<g id="node5" class="node">
<title>action1</title>
<path fill="beige" stroke="black" d="M394,-1414C394,-1414 87,-1414 87,-1414 81,-1414 75,-1408 75,-1402 75,-1402 75,-1358 75,-1358 75,-1352 81,-1346 87,-1346 87,-1346 394,-1346 394,-1346 400,-1346 406,-1352 406,-1358 406,-1358 406,-1402 406,-1402 406,-1408 400,-1414 394,-1414"/>
<text text-anchor="middle" x="240.5" y="-1398.8" font-family="Times,serif" font-size="14.00">C++ CODE ACTION:</text>
<text text-anchor="middle" x="240.5" y="-1383.8" font-family="Times,serif" font-size="14.00">Parse `buffer` and store key fields:</text>
<text text-anchor="middle" x="240.5" y="-1368.8" font-family="Times,serif" font-size="14.00">`req_id` = 0xABCD</text>
<text text-anchor="middle" x="240.5" y="-1353.8" font-family="Times,serif" font-size="14.00">`questions` vector gets the QNAME/TYPE/CLASS block</text>
</g>
<!-- client_query&#45;&gt;action1 -->
<g id="edge1" class="edge">
<title>client_query&#45;&gt;action1</title>
<path fill="none" stroke="black" d="M240.5,-1486.79C240.5,-1486.79 240.5,-1424.04 240.5,-1424.04"/>
<polygon fill="black" stroke="black" points="244,-1424.04 240.5,-1414.04 237,-1424.04 244,-1424.04"/>
</g>
<!-- forwarded_query -->
<g id="node2" class="node">
<title>forwarded_query</title>
<path fill="beige" stroke="transparent" d="M387.5,-1152C387.5,-1152 93.5,-1152 93.5,-1152 87.5,-1152 81.5,-1146 81.5,-1140 81.5,-1140 81.5,-963 81.5,-963 81.5,-957 87.5,-951 93.5,-951 93.5,-951 387.5,-951 387.5,-951 393.5,-951 399.5,-957 399.5,-963 399.5,-963 399.5,-1140 399.5,-1140 399.5,-1146 393.5,-1152 387.5,-1152"/>
<polygon fill="lightyellow" stroke="transparent" points="89.5,-1126.5 89.5,-1147.5 391.5,-1147.5 391.5,-1126.5 89.5,-1126.5"/>
<polygon fill="none" stroke="black" points="89.5,-1126.5 89.5,-1147.5 391.5,-1147.5 391.5,-1126.5 89.5,-1126.5"/>
<text text-anchor="start" x="98" y="-1134.3" font-family="Times,serif" font-weight="bold" font-size="14.00">2. Forwarded Query (Assembled in `fwdPacket`)</text>
<polygon fill="none" stroke="black" points="89.5,-1105.5 89.5,-1126.5 162.5,-1126.5 162.5,-1105.5 89.5,-1105.5"/>
<text text-anchor="start" x="99.5" y="-1112.3" font-family="Times,serif" font-size="14.00">Bytes 0&#45;1</text>
<polygon fill="none" stroke="black" points="162.5,-1105.5 162.5,-1126.5 391.5,-1126.5 391.5,-1105.5 162.5,-1105.5"/>
<text text-anchor="start" x="214.5" y="-1112.3" font-family="Times,serif" font-size="14.00" fill="blue">ID: 0xABCD (Copied)</text>
<polygon fill="none" stroke="black" points="89.5,-1084.5 89.5,-1105.5 162.5,-1105.5 162.5,-1084.5 89.5,-1084.5"/>
<text text-anchor="start" x="99.5" y="-1091.3" font-family="Times,serif" font-size="14.00">Bytes 2&#45;3</text>
<polygon fill="none" stroke="black" points="162.5,-1084.5 162.5,-1105.5 391.5,-1105.5 391.5,-1084.5 162.5,-1084.5"/>
<text text-anchor="start" x="189.5" y="-1092.3" font-family="Times,serif" font-weight="bold" font-size="14.00" fill="red">Flags: 0x0100 (Newly written)</text>
<polygon fill="none" stroke="black" points="89.5,-1063.5 89.5,-1084.5 162.5,-1084.5 162.5,-1063.5 89.5,-1063.5"/>
<text text-anchor="start" x="99.5" y="-1070.3" font-family="Times,serif" font-size="14.00">Bytes 4&#45;5</text>
<polygon fill="none" stroke="black" points="162.5,-1063.5 162.5,-1084.5 391.5,-1084.5 391.5,-1063.5 162.5,-1063.5"/>
<text text-anchor="start" x="187" y="-1071.3" font-family="Times,serif" font-weight="bold" font-size="14.00" fill="red">QDCOUNT: 1 (Newly written)</text>
<polygon fill="none" stroke="black" points="89.5,-1042.5 89.5,-1063.5 162.5,-1063.5 162.5,-1042.5 89.5,-1042.5"/>
<text text-anchor="start" x="96" y="-1049.3" font-family="Times,serif" font-size="14.00">Bytes 6&#45;11</text>
<polygon fill="none" stroke="black" points="162.5,-1042.5 162.5,-1063.5 391.5,-1063.5 391.5,-1042.5 162.5,-1042.5"/>
<text text-anchor="start" x="165.5" y="-1050.3" font-family="Times,serif" font-weight="bold" font-size="14.00" fill="red">AN/NS/ARCOUNT: 0 (Newly written)</text>
<polygon fill="lightgrey" stroke="transparent" points="89.5,-1017.5 89.5,-1038.5 391.5,-1038.5 391.5,-1017.5 89.5,-1017.5"/>
<polygon fill="none" stroke="black" points="89.5,-1017.5 89.5,-1038.5 391.5,-1038.5 391.5,-1017.5 89.5,-1017.5"/>
<text text-anchor="start" x="194" y="-1025.3" font-family="Times,serif" font-style="italic" font-size="14.00">Question Section</text>
<polygon fill="none" stroke="black" points="89.5,-996.5 89.5,-1017.5 162.5,-1017.5 162.5,-996.5 89.5,-996.5"/>
<text text-anchor="start" x="92.5" y="-1003.3" font-family="Times,serif" font-size="14.00">Bytes 12&#45;23</text>
<polygon fill="none" stroke="black" points="162.5,-996.5 162.5,-1017.5 391.5,-1017.5 391.5,-996.5 162.5,-996.5"/>
<text text-anchor="start" x="176.5" y="-1003.3" font-family="Times,serif" font-size="14.00" fill="blue">QNAME: 7example3com0 (Copied)</text>
<polygon fill="none" stroke="black" points="89.5,-975.5 89.5,-996.5 162.5,-996.5 162.5,-975.5 89.5,-975.5"/>
<text text-anchor="start" x="92.5" y="-982.3" font-family="Times,serif" font-size="14.00">Bytes 24&#45;25</text>
<polygon fill="none" stroke="black" points="162.5,-975.5 162.5,-996.5 391.5,-996.5 391.5,-975.5 162.5,-975.5"/>
<text text-anchor="start" x="189.5" y="-982.3" font-family="Times,serif" font-size="14.00" fill="blue">QTYPE: 1 (A Record) (Copied)</text>
<polygon fill="none" stroke="black" points="89.5,-954.5 89.5,-975.5 162.5,-975.5 162.5,-954.5 89.5,-954.5"/>
<text text-anchor="start" x="92.5" y="-961.3" font-family="Times,serif" font-size="14.00">Bytes 26&#45;27</text>
<polygon fill="none" stroke="black" points="162.5,-954.5 162.5,-975.5 391.5,-975.5 391.5,-954.5 162.5,-954.5"/>
<text text-anchor="start" x="204.5" y="-961.3" font-family="Times,serif" font-size="14.00" fill="blue">QCLASS: 1 (IN) (Copied)</text>
</g>
<!-- resolver_response -->
<g id="node3" class="node">
<title>resolver_response</title>
<path fill="beige" stroke="transparent" d="M388.5,-846C388.5,-846 92.5,-846 92.5,-846 86.5,-846 80.5,-840 80.5,-834 80.5,-834 80.5,-573 80.5,-573 80.5,-567 86.5,-561 92.5,-561 92.5,-561 388.5,-561 388.5,-561 394.5,-561 400.5,-567 400.5,-573 400.5,-573 400.5,-834 400.5,-834 400.5,-840 394.5,-846 388.5,-846"/>
<polygon fill="lightgreen" stroke="transparent" points="88.5,-820.5 88.5,-841.5 392.5,-841.5 392.5,-820.5 88.5,-820.5"/>
<polygon fill="none" stroke="black" points="88.5,-820.5 88.5,-841.5 392.5,-841.5 392.5,-820.5 88.5,-820.5"/>
<text text-anchor="start" x="108" y="-828.3" font-family="Times,serif" font-weight="bold" font-size="14.00">3. Resolver Response (Received in `fwdResp`)</text>
<polygon fill="none" stroke="black" points="88.5,-799.5 88.5,-820.5 161.5,-820.5 161.5,-799.5 88.5,-799.5"/>
<text text-anchor="start" x="98.5" y="-806.3" font-family="Times,serif" font-size="14.00">Bytes 0&#45;1</text>
<polygon fill="none" stroke="black" points="161.5,-799.5 161.5,-820.5 392.5,-820.5 392.5,-799.5 161.5,-799.5"/>
<text text-anchor="start" x="240.5" y="-806.3" font-family="Times,serif" font-size="14.00">ID: 0xABCD</text>
<polygon fill="none" stroke="black" points="88.5,-778.5 88.5,-799.5 161.5,-799.5 161.5,-778.5 88.5,-778.5"/>
<text text-anchor="start" x="98.5" y="-785.3" font-family="Times,serif" font-size="14.00">Bytes 2&#45;3</text>
<polygon fill="none" stroke="black" points="161.5,-778.5 161.5,-799.5 392.5,-799.5 392.5,-778.5 161.5,-778.5"/>
<text text-anchor="start" x="192.5" y="-785.3" font-family="Times,serif" font-size="14.00">Flags: 0x8180 (Response, RA)</text>
<polygon fill="none" stroke="black" points="88.5,-757.5 88.5,-778.5 161.5,-778.5 161.5,-757.5 88.5,-757.5"/>
<text text-anchor="start" x="98.5" y="-764.3" font-family="Times,serif" font-size="14.00">Bytes 4&#45;7</text>
<polygon fill="none" stroke="black" points="161.5,-757.5 161.5,-778.5 392.5,-778.5 392.5,-757.5 161.5,-757.5"/>
<text text-anchor="start" x="194" y="-764.3" font-family="Times,serif" font-size="14.00">QDCOUNT: 1, ANCOUNT: 1</text>
<polygon fill="none" stroke="black" points="88.5,-736.5 88.5,-757.5 161.5,-757.5 161.5,-736.5 88.5,-736.5"/>
<text text-anchor="start" x="119" y="-743.3" font-family="Times,serif" font-size="14.00">...</text>
<polygon fill="none" stroke="black" points="161.5,-736.5 161.5,-757.5 392.5,-757.5 392.5,-736.5 161.5,-736.5"/>
<text text-anchor="start" x="271" y="-743.3" font-family="Times,serif" font-size="14.00">...</text>
<polygon fill="lightgrey" stroke="transparent" points="88.5,-715.5 88.5,-736.5 392.5,-736.5 392.5,-715.5 88.5,-715.5"/>
<polygon fill="none" stroke="black" points="88.5,-715.5 88.5,-736.5 392.5,-736.5 392.5,-715.5 88.5,-715.5"/>
<text text-anchor="start" x="194" y="-723.3" font-family="Times,serif" font-style="italic" font-size="14.00">Question Section</text>
<polygon fill="none" stroke="black" points="88.5,-694.5 88.5,-715.5 161.5,-715.5 161.5,-694.5 88.5,-694.5"/>
<text text-anchor="start" x="96.5" y="-701.3" font-family="Times,serif" font-size="14.00">Bytes 12+</text>
<polygon fill="none" stroke="black" points="161.5,-694.5 161.5,-715.5 392.5,-715.5 392.5,-694.5 161.5,-694.5"/>
<text text-anchor="start" x="188" y="-701.3" font-family="Times,serif" font-size="14.00">...Same as forwarded question...</text>
<polygon fill="lightgrey" stroke="transparent" points="88.5,-669.5 88.5,-690.5 392.5,-690.5 392.5,-669.5 88.5,-669.5"/>
<polygon fill="none" stroke="black" points="88.5,-669.5 88.5,-690.5 392.5,-690.5 392.5,-669.5 88.5,-669.5"/>
<text text-anchor="start" x="198" y="-677.3" font-family="Times,serif" font-style="italic" font-size="14.00">Answer Section</text>
<polygon fill="none" stroke="black" points="88.5,-648.5 88.5,-669.5 161.5,-669.5 161.5,-648.5 88.5,-648.5"/>
<text text-anchor="start" x="91.5" y="-655.3" font-family="Times,serif" font-size="14.00">Bytes 28&#45;29</text>
<polygon fill="none" stroke="black" points="161.5,-648.5 161.5,-669.5 392.5,-669.5 392.5,-648.5 161.5,-648.5"/>
<text text-anchor="start" x="164.5" y="-656.3" font-family="Times,serif" font-weight="bold" font-size="14.00" fill="green">NAME: 0xC00C (Pointer to QNAME)</text>
<polygon fill="none" stroke="black" points="88.5,-627.5 88.5,-648.5 161.5,-648.5 161.5,-627.5 88.5,-627.5"/>
<text text-anchor="start" x="91.5" y="-634.3" font-family="Times,serif" font-size="14.00">Bytes 30&#45;33</text>
<polygon fill="none" stroke="black" points="161.5,-627.5 161.5,-648.5 392.5,-648.5 392.5,-627.5 161.5,-627.5"/>
<text text-anchor="start" x="218" y="-635.3" font-family="Times,serif" font-weight="bold" font-size="14.00" fill="green">TYPE: 1, CLASS: 1</text>
<polygon fill="none" stroke="black" points="88.5,-606.5 88.5,-627.5 161.5,-627.5 161.5,-606.5 88.5,-606.5"/>
<text text-anchor="start" x="91.5" y="-613.3" font-family="Times,serif" font-size="14.00">Bytes 34&#45;37</text>
<polygon fill="none" stroke="black" points="161.5,-606.5 161.5,-627.5 392.5,-627.5 392.5,-606.5 161.5,-606.5"/>
<text text-anchor="start" x="221.5" y="-614.3" font-family="Times,serif" font-weight="bold" font-size="14.00" fill="green">TTL: 60 (example)</text>
<polygon fill="none" stroke="black" points="88.5,-585.5 88.5,-606.5 161.5,-606.5 161.5,-585.5 88.5,-585.5"/>
<text text-anchor="start" x="91.5" y="-592.3" font-family="Times,serif" font-size="14.00">Bytes 38&#45;39</text>
<polygon fill="none" stroke="black" points="161.5,-585.5 161.5,-606.5 392.5,-606.5 392.5,-585.5 161.5,-585.5"/>
<text text-anchor="start" x="230" y="-593.3" font-family="Times,serif" font-weight="bold" font-size="14.00" fill="green">RDLENGTH: 4</text>
<polygon fill="none" stroke="black" points="88.5,-564.5 88.5,-585.5 161.5,-585.5 161.5,-564.5 88.5,-564.5"/>
<text text-anchor="start" x="91.5" y="-571.3" font-family="Times,serif" font-size="14.00">Bytes 40&#45;43</text>
<polygon fill="none" stroke="black" points="161.5,-564.5 161.5,-585.5 392.5,-585.5 392.5,-564.5 161.5,-564.5"/>
<text text-anchor="start" x="210" y="-572.3" font-family="Times,serif" font-weight="bold" font-size="14.00" fill="green">RDATA: 93.184.216.34</text>
</g>
<!-- forwarded_query&#45;&gt;resolver_response -->
<g id="edge4" class="edge">
<title>forwarded_query&#45;&gt;resolver_response</title>
<path fill="none" stroke="black" stroke-dasharray="5,2" d="M240.5,-950.84C240.5,-950.84 240.5,-856.31 240.5,-856.31"/>
<polygon fill="black" stroke="black" points="244,-856.31 240.5,-846.31 237,-856.31 244,-856.31"/>
<text text-anchor="middle" x="299.5" y="-907" font-family="Times,serif" font-size="10.00">Network Hop:</text>
<text text-anchor="middle" x="299.5" y="-896" font-family="Times,serif" font-size="10.00">Resolver processes the query</text>
<text text-anchor="middle" x="299.5" y="-885" font-family="Times,serif" font-size="10.00">and sends this response back</text>
</g>
<!-- action3 -->
<g id="node7" class="node">
<title>action3</title>
<path fill="beige" stroke="black" d="M403.5,-488C403.5,-488 77.5,-488 77.5,-488 71.5,-488 65.5,-482 65.5,-476 65.5,-476 65.5,-447 65.5,-447 65.5,-441 71.5,-435 77.5,-435 77.5,-435 403.5,-435 403.5,-435 409.5,-435 415.5,-441 415.5,-447 415.5,-447 415.5,-476 415.5,-476 415.5,-482 409.5,-488 403.5,-488"/>
<text text-anchor="middle" x="240.5" y="-472.8" font-family="Times,serif" font-size="14.00">C++ CODE ACTION:</text>
<text text-anchor="middle" x="240.5" y="-457.8" font-family="Times,serif" font-size="14.00">Skip Header &amp; Question of `fwdResp`.</text>
<text text-anchor="middle" x="240.5" y="-442.8" font-family="Times,serif" font-size="14.00">Copy the rest (the Answer Section) into the `answers` vector.</text>
</g>
<!-- resolver_response&#45;&gt;action3 -->
<g id="edge5" class="edge">
<title>resolver_response&#45;&gt;action3</title>
<path fill="none" stroke="black" d="M240.5,-560.98C240.5,-560.98 240.5,-498.18 240.5,-498.18"/>
<polygon fill="black" stroke="black" points="244,-498.18 240.5,-488.18 237,-498.18 244,-498.18"/>
</g>
<!-- final_response -->
<g id="node4" class="node">
<title>final_response</title>
<path fill="beige" stroke="transparent" d="M469,-226C469,-226 12,-226 12,-226 6,-226 0,-220 0,-214 0,-214 0,-12 0,-12 0,-6 6,0 12,0 12,0 469,0 469,0 475,0 481,-6 481,-12 481,-12 481,-214 481,-214 481,-220 475,-226 469,-226"/>
<polygon fill="orange" stroke="transparent" points="8.5,-201 8.5,-222 473.5,-222 473.5,-201 8.5,-201"/>
<polygon fill="none" stroke="black" points="8.5,-201 8.5,-222 473.5,-222 473.5,-201 8.5,-201"/>
<text text-anchor="start" x="113" y="-208.8" font-family="Times,serif" font-weight="bold" font-size="14.00">4. Final Response (Assembled in `response`)</text>
<polygon fill="none" stroke="black" points="8.5,-180 8.5,-201 81.5,-201 81.5,-180 8.5,-180"/>
<text text-anchor="start" x="18.5" y="-186.8" font-family="Times,serif" font-size="14.00">Bytes 0&#45;1</text>
<polygon fill="none" stroke="black" points="81.5,-180 81.5,-201 473.5,-201 473.5,-180 81.5,-180"/>
<text text-anchor="start" x="179.5" y="-186.8" font-family="Times,serif" font-size="14.00" fill="blue">ID: 0xABCD (From original query)</text>
<polygon fill="none" stroke="black" points="8.5,-159 8.5,-180 81.5,-180 81.5,-159 8.5,-159"/>
<text text-anchor="start" x="18.5" y="-165.8" font-family="Times,serif" font-size="14.00">Bytes 2&#45;3</text>
<polygon fill="none" stroke="black" points="81.5,-159 81.5,-180 473.5,-180 473.5,-159 81.5,-159"/>
<text text-anchor="start" x="155.5" y="-166.8" font-family="Times,serif" font-weight="bold" font-size="14.00" fill="red">Flags: 0x8180 (Newly built response flags)</text>
<polygon fill="none" stroke="black" points="8.5,-138 8.5,-159 81.5,-159 81.5,-138 8.5,-138"/>
<text text-anchor="start" x="18.5" y="-144.8" font-family="Times,serif" font-size="14.00">Bytes 4&#45;5</text>
<polygon fill="none" stroke="black" points="81.5,-138 81.5,-159 473.5,-159 473.5,-138 81.5,-138"/>
<text text-anchor="start" x="176" y="-144.8" font-family="Times,serif" font-size="14.00" fill="blue">QDCOUNT: 1 (From original query)</text>
<polygon fill="none" stroke="black" points="8.5,-117 8.5,-138 81.5,-138 81.5,-117 8.5,-117"/>
<text text-anchor="start" x="18.5" y="-123.8" font-family="Times,serif" font-size="14.00">Bytes 6&#45;7</text>
<polygon fill="none" stroke="black" points="81.5,-117 81.5,-138 473.5,-138 473.5,-117 81.5,-117"/>
<text text-anchor="start" x="152" y="-124.8" font-family="Times,serif" font-weight="bold" font-size="14.00" fill="red">ANCOUNT: 1 (Based on received answers)</text>
<polygon fill="none" stroke="black" points="8.5,-96 8.5,-117 81.5,-117 81.5,-96 8.5,-96"/>
<text text-anchor="start" x="15" y="-102.8" font-family="Times,serif" font-size="14.00">Bytes 8&#45;11</text>
<polygon fill="none" stroke="black" points="81.5,-96 81.5,-117 473.5,-117 473.5,-96 81.5,-96"/>
<text text-anchor="start" x="178" y="-103.8" font-family="Times,serif" font-weight="bold" font-size="14.00" fill="red">NS/ARCOUNT: 0 (Newly written)</text>
<polygon fill="lightgrey" stroke="transparent" points="8.5,-71 8.5,-92 473.5,-92 473.5,-71 8.5,-71"/>
<polygon fill="none" stroke="black" points="8.5,-71 8.5,-92 473.5,-92 473.5,-71 8.5,-71"/>
<text text-anchor="start" x="194.5" y="-78.8" font-family="Times,serif" font-style="italic" font-size="14.00">Question Section</text>
<polygon fill="none" stroke="black" points="8.5,-50 8.5,-71 81.5,-71 81.5,-50 8.5,-50"/>
<text text-anchor="start" x="11.5" y="-56.8" font-family="Times,serif" font-size="14.00">Bytes 12&#45;27</text>
<polygon fill="none" stroke="black" points="81.5,-50 81.5,-71 473.5,-71 473.5,-50 81.5,-50"/>
<text text-anchor="start" x="127" y="-56.8" font-family="Times,serif" font-size="14.00" fill="blue">...Entire Question section copied from original query...</text>
<polygon fill="lightgrey" stroke="transparent" points="8.5,-25 8.5,-46 473.5,-46 473.5,-25 8.5,-25"/>
<polygon fill="none" stroke="black" points="8.5,-25 8.5,-46 473.5,-46 473.5,-25 8.5,-25"/>
<text text-anchor="start" x="198.5" y="-32.8" font-family="Times,serif" font-style="italic" font-size="14.00">Answer Section</text>
<polygon fill="none" stroke="black" points="8.5,-4 8.5,-25 81.5,-25 81.5,-4 8.5,-4"/>
<text text-anchor="start" x="11.5" y="-10.8" font-family="Times,serif" font-size="14.00">Bytes 28&#45;43</text>
<polygon fill="none" stroke="black" points="81.5,-4 81.5,-25 473.5,-25 473.5,-4 81.5,-4"/>
<text text-anchor="start" x="84.5" y="-11.8" font-family="Times,serif" font-weight="bold" font-size="14.00" fill="green">...Entire Answer section copied verbatim from resolver response...</text>
</g>
<!-- action2 -->
<g id="node6" class="node">
<title>action2</title>
<path fill="beige" stroke="black" d="M382.5,-1273C382.5,-1273 98.5,-1273 98.5,-1273 92.5,-1273 86.5,-1267 86.5,-1261 86.5,-1261 86.5,-1247 86.5,-1247 86.5,-1241 92.5,-1235 98.5,-1235 98.5,-1235 382.5,-1235 382.5,-1235 388.5,-1235 394.5,-1241 394.5,-1247 394.5,-1247 394.5,-1261 394.5,-1261 394.5,-1267 388.5,-1273 382.5,-1273"/>
<text text-anchor="middle" x="240.5" y="-1257.8" font-family="Times,serif" font-size="14.00">C++ CODE ACTION:</text>
<text text-anchor="middle" x="240.5" y="-1242.8" font-family="Times,serif" font-size="14.00">Build `fwdPacket` by combining stored and new data</text>
</g>
<!-- action1&#45;&gt;action2 -->
<g id="edge2" class="edge">
<title>action1&#45;&gt;action2</title>
<path fill="none" stroke="black" d="M240.5,-1345.9C240.5,-1345.9 240.5,-1283.24 240.5,-1283.24"/>
<polygon fill="black" stroke="black" points="244,-1283.24 240.5,-1273.24 237,-1283.24 244,-1283.24"/>
</g>
<!-- action2&#45;&gt;forwarded_query -->
<g id="edge3" class="edge">
<title>action2&#45;&gt;forwarded_query</title>
<path fill="none" stroke="black" d="M240.5,-1234.95C240.5,-1234.95 240.5,-1162.35 240.5,-1162.35"/>
<polygon fill="black" stroke="black" points="244,-1162.35 240.5,-1152.35 237,-1162.35 244,-1162.35"/>
<text text-anchor="middle" x="303.5" y="-1191" font-family="Times,serif" font-size="10.00">Forward this packet to resolver</text>
</g>
<!-- action4 -->
<g id="node8" class="node">
<title>action4</title>
<path fill="beige" stroke="black" d="M391,-362C391,-362 90,-362 90,-362 84,-362 78,-356 78,-350 78,-350 78,-321 78,-321 78,-315 84,-309 90,-309 90,-309 391,-309 391,-309 397,-309 403,-315 403,-321 403,-321 403,-350 403,-350 403,-356 397,-362 391,-362"/>
<text text-anchor="middle" x="240.5" y="-346.8" font-family="Times,serif" font-size="14.00">C++ CODE ACTION:</text>
<text text-anchor="middle" x="240.5" y="-331.8" font-family="Times,serif" font-size="14.00">Build final `response` buffer by stitching together pieces</text>
<text text-anchor="middle" x="240.5" y="-316.8" font-family="Times,serif" font-size="14.00">from the original query and the resolver&#39;s answer.</text>
</g>
<!-- action3&#45;&gt;action4 -->
<g id="edge6" class="edge">
<title>action3&#45;&gt;action4</title>
<path fill="none" stroke="black" d="M240.5,-434.78C240.5,-434.78 240.5,-372.18 240.5,-372.18"/>
<polygon fill="black" stroke="black" points="244,-372.18 240.5,-362.18 237,-372.18 244,-372.18"/>
</g>
<!-- action4&#45;&gt;final_response -->
<g id="edge7" class="edge">
<title>action4&#45;&gt;final_response</title>
<path fill="none" stroke="black" d="M240.5,-308.66C240.5,-308.66 240.5,-236.11 240.5,-236.11"/>
<polygon fill="black" stroke="black" points="244,-236.11 240.5,-226.11 237,-236.11 244,-236.11"/>
<text text-anchor="middle" x="303" y="-265" font-family="Times,serif" font-size="10.00">Send this packet back to client</text>
</g>
</g>
</svg>
